"use strict";!function(){function f(t,e,n,i){var o=document.createElement(t);return o.setAttribute("id",e),o.setAttribute("class",n),o.setAttribute("style",i),o}function a(){var t,e,n=(t=window.pfSiteData.plugin_url+"Libraries/tinymce/js/tinymce/tinymce.min.js",(e=document.createElement("script")).src=t,window.pfnt.windows.scripts.push(e),e);n.onload=function(){console.log("init nt wysiwyg"),window.initEditor()};var i=document.getElementsByTagName("head")[0];i.prepend(n);var o=document.createElement("style");o.innerHTML='#wp-nomthis-editor-container { width: 100%; } \n #pressforward-nt { color: #111; } \n #pressforward-nt h1, #pressforward-nt h2, #pressforward-nt h3, #pressforward-nt h5 { color: #111; } \n #pressforward-nt input { color: #111; margin-bottom: 1px; } \n .pressforward-nt__inputfield { width:100%; display:block; color: #111; } \n #pressforward-nt input { color: #111; background-color: white; cursor: text; padding: 1px; border-width: 2px; border-style: inset; } \n .pressforward-nt__inner-container { height: 100%; } \n .meta-box { background-color: whitesmoke; } \n .meta-box img { max-height: 100%; } \n .meta-box h5 { font-family: "Arial Black", Gadget, sans-serif; border: 3px #bbbbbb inset; padding: 3px; height: 17%; margin-bottom: 2%; box-sizing: border-box; min-height: 33px; font-size: 14px; } \n .pressforward-nt__li-category-select-item { margin-bottom: 6px; padding: 0; line-height: 22px; word-wrap: break-word; } \n .pressforward-nt__li-category-select-item li { font-size: 16px; max-height: 25px; color: black; border-bottom-color: rgb(180, 185, 190); border-bottom-width: 1px; }  \n #pressforward-nt__right ul, #pressforward-nt__right li { list-style-type: none; } \n #pressforward-nt__right ul .select-inner-text { margin-left: 4px; vertical-align: middle; } \n #pressforward-nt__preview-category-container__inner input[type=checkbox], #pressforward-nt__preview-category-container__inner label { cursor: pointer; } \n '+window.pfSiteData.fontFace,window.pfnt.windows.styleBlocks.push(o),i.prepend(o)}function s(d,e){var n="";e?n="?page="+e:e=1;new Promise(function(o,t){var r=new XMLHttpRequest;r.open("GET",window.pfSiteData.categories_endpoint+n,!0),r.addEventListener("load",function(t){var e,n,i;4==r.readyState&&200==r.status?(e=JSON.parse(r.responseText),n=r.getResponseHeader("X-WP-Total"),i=r.getResponseHeader("X-WP-TotalPages"),console.log("cat list:",e,n,i),e.reduce(function(t,e,n,i){return t.then(function(){return function p(l,c){return new Promise(function(e,t){var i=window.document.getElementById("category-"+c.id);if(null!==i)return e(!0),!0;i=f("li","category-"+c.id,"pressforward-nt__li-category-select-item");var n=f("label","","selectit",""),o=f("input","in-category-"+c.id,"pressforward-nt__li-select-item__input","");o.setAttribute("value",c.id),o.setAttribute("type","checkbox"),o.setAttribute("name","post_category[]");var r,d,a,s,w=f("span","","select-inner-text","");w.innerHTML=c.name,n.appendChild(o),n.appendChild(w),i.prepend(n),0!==c.parent?(r=window.document.querySelector("#category-"+c.parent+" ul"),d=window.document.getElementById("category-"+c.parent),null===r&&null===d?((a=new XMLHttpRequest).open("GET",c._links.up[0].href,!0),a.addEventListener("load",function(t){var n;4==a.readyState&&200==a.status?(n=JSON.parse(a.responseText),console.log("cat parent:",n),e(new Promise(function(e,t){p(l,n).then(function(){d=window.document.getElementById("category-"+c.parent);var t=f("ul","","select-inner-text","");d.appendChild(t),(r=t).appendChild(i),e(!0)})}))):(console.log(n),alert("Cat retrieve failed"),e(!1))}),a.send()):(null===r?(s=f("ul","","select-inner-text",""),d.appendChild(s),(r=s).appendChild(i)):r.appendChild(i),e(!0))):(l.appendChild(i),e(!0))})}(d,e)})},Promise.resolve([])).then(function(t){o({totalPages:i})})):(console.log(e),alert("Cat retrieve failed"))}),r.send()}).then(function(t){e+1<=t.totalPages&&s(d,e+1)})}console.log("Nominate This Setup"),null!==document.getElementById("pressforward-nt")&&window.pfnt_deactivate(),window.pfnt={},window.pfnt.windows={},window.pfnt.windows.links=[],window.pfnt.windows.scripts=[],window.pfnt.windows.styleBlocks=[],window.pfnt.styles={},window.pfnt.tools={},window.pfReadability={},window.pfnt.key=window.ku,window.pfnt.selection=window.getSelection().toString(),window.pfnt.submitObject={post_title:!1,item_link:window.location.href,pf_source_link:window.location.origin,post_status:!1,content:!1,tax_input:!1,item_feat_img:!1,item_author:!1,post_tags:!1,user_key:window.ku,photo_src:[],photo_description:[],action:"post"},function(){window.pfnt;var t=window.pfnt.windows,e=window.pfnt.styles,n=(window.pfnt.tools,document.cloneNode(!0));window.pfReadability.article=new Readability(n).parse(),t.mainWindow=f("div","pressforward-nt","nomthis-wrapper",""),t.innerWindow=f("div","pressforward-nt__inner","nomthis-inner-wrapper",""),t.titleField=f("input","pressforward-nt__inputfield__title","pressforward-nt__inputfield",""),t.titleField.setAttribute("type","text"),window.pfReadability.article.title<=1?t.titleField.setAttribute("value",window.pfMetaData.title):t.titleField.setAttribute("value",window.pfReadability.article.title),t.bylineField=f("input","pressforward-nt__inputfield__byline","pressforward-nt__inputfield",""),t.bylineField.setAttribute("type","text"),window.pfMetaData&&window.pfMetaData.hasOwnProperty("author")?t.bylineField.setAttribute("value",window.pfMetaData.author):window.pfReadability&&window.pfReadability.hasOwnProperty("article")&&window.pfReadability.article.hasOwnProperty("byline")&&window.pfReadability.article.byline.length<=1&&t.bylineField.setAttribute("value",window.pfReadability.article.byline),e.mwStyles="position: fixed;width: 76%;height: 550px;display: block;background: #c7c7c7;top: 0;left: 12%;padding: 1px;box-sizing: border-box;z-index: 9999990000;",e.iwStyles="position: relative;width: 100%;height: 100%;background: white;border: #afceaf 3px solid;box-sizing: border-box;",t.mainWindow.setAttribute("style",e.mwStyles),t.innerWindow.setAttribute("style",e.iwStyles),t.innerLeft=f("div","pressforward-nt__left","pressforward-nt__inner-container","float:left; width:60%"),t.innerRight=f("div","pressforward-nt__right","pressforward-nt__inner-container","float:right; width:37%; padding-left: 1%; padding: 0 10px;");var i,o,r,d="",d=2<window.pfnt.selection.length?window.pfnt.selection:window.pfReadability.article.content;document.getElementsByTagName("body")[0].prepend(window.pfnt.windows.mainWindow),window.pfnt.windows.mainWindow.appendChild(window.pfnt.windows.innerWindow),window.pfnt.windows.innerWindow.appendChild(window.pfnt.windows.innerLeft),window.pfnt.windows.innerWindow.appendChild(window.pfnt.windows.innerRight),window.pfnt.windows.innerLeft.appendChild(window.pfnt.windows.titleField),window.pfnt.windows.innerLeft.appendChild(window.pfnt.windows.bylineField),window.pfnt.windows.innerLeft.appendChild((i=d,o=f("div","wp-nomthis-editor-container","wp-editor-container",""),f("div","qt_nomthis_toolbar","quicktags-toolbar",""),(r=f("textarea","nominateText","wp-editor-area","height:375px;")).setAttribute("name","post_content"),r.setAttribute("autocomplete","off"),r.setAttribute("cols","40"),r.innerHTML=i,o.appendChild(r),window.pfnt.windows.editorContainer=o)),function(t){var e=f("div","pressforward-nt__preview-image","preview-image","background-image: url("+window.pfMetaData.image+");width: 100%;background-size: contain;background-repeat: no-repeat;background-position: center;background-color: transparent;height: 77%;display: block;box-sizing: border-box;");e.src=window.pfMetaData.image;var n=f("div","pressforward-nt__preview-tags-container","meta-box pressforward-nt-box","height:18%; overflow:hidden; display: block;");n.innerHTML='<h5>Tags</h5><input type="text" value="'+window.pfMetaData.keywords.join(", ")+'" style="width: 80%;height: 26px;font-size: small;margin-left: 10px;">';var i=f("div","pressforward-nt__preview-image-container","meta-box pressforward-nt-box","height:36%; overflow:hidden; display: block;");i.innerHTML="<h5>Preview Image</h5>",i.appendChild(e);var o=f("div","pressforward-nt__button-container","meta-box pressforward-nt-box","height:12%; overflow:hidden; display: block;");o.innerHTML='<button id="submit-button" role="presentation" type="button" tabindex="-1" style="width: 100px; height: 30px; margin: 22px 10px; float: right; font-size: 14px;" onclick="window.pfntSubmit(true)">Submit</button>',o.innerHTML+='<button id="nominate-button" role="presentation" type="button" tabindex="-1" style="width: 100px; height: 30px; margin: 22px 10px; float: right; font-size: 14px;" onclick="window.pfntSubmit(false)">Nominate</button>';var r=f("div","pressforward-nt__preview-category-container","meta-box pressforward-nt-box","height:34%; overflow:hidden; display: block;");r.innerHTML="<h5>Categories</h5>";var d=f("ul","pressforward-nt__preview-category-container__inner","checkable-list-container","margin-left: 5px; height: 83%; width:100%; overflow:scroll; display: block;");r.appendChild(d),s(d),t.appendChild(r),t.appendChild(n),t.appendChild(i),t.appendChild(o)}(window.pfnt.windows.innerRight),window.initEditor=function(){window.ntEditor=tinymce.init({selector:"#nominateText"})},a()}()}(),window.pfnt_deactivate=function(){!function(t){for(;t.hasChildNodes();)!function t(e){for(;e.hasChildNodes();)t(e.firstChild);e.parentNode.removeChild(e);console.log(e,"cleared!")}(t.firstChild)}(window.pfnt.windows.mainWindow),window.pfnt.windows.mainWindow.remove()},window.pfntSubmit=function(t){console.log("Submitting to PressForward"),window.pfnt.submitObject.post_title=window.document.getElementById("pressforward-nt__inputfield__title").value,window.pfnt.submitObject.item_author=window.document.getElementById("pressforward-nt__inputfield__byline").value,window.pfnt.submitObject.content=tinymce.activeEditor.dom.doc.body.innerHTML,window.pfnt.submitObject.item_feat_img=window.pfMetaData.image,window.pfnt.submitObject.post_tags=window.document.querySelector("#pressforward-nt__preview-tags-container input").value,window.pfnt.submitObject.post_category="";var e=window.document.getElementsByClassName("pressforward-nt__li-select-item__input");for(categoryCheckbox in e)!0===categoryCheckbox.checked&&(window.pfnt.submitObject.post_category+=categoryCheckbox.value+",");window.pfnt.submitObject.post_category+="",t&&(window.pfnt.submitObject.publish="Last Step",window.pfnt.submitObject.post_status="publish");var n,i=[];Object.keys(window.pfnt.submitObject).forEach(function(t){var e;window.pfnt.submitObject[t]&&(e="string"==typeof window.pfnt.submitObject[t]?window.pfnt.submitObject[t].trim():window.pfnt.submitObject[t],i.push(encodeURIComponent(t.trim())+"="+encodeURIComponent(e)))}),n=i.join("&").replace(/%20/g,"+");var o=new XMLHttpRequest;o.open("POST",pfSiteData.submit_endpoint,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.addEventListener("load",function(t){var e;4==o.readyState&&200==o.status?(e=JSON.parse(o.responseText),console.log(e)):(console.log(e),alert("Nomination failed"))}),o.send(n)};