!function(o){wp.api.loadPromise.done(function(){var t=window.wpApiSettings||{};wp.api.init({versionString:"pf/v1",apiRoot:t.root||wp.api.utils.getRootUrl()+"wp-json/"}),o(document).ready(function(){o("#build-authors").on("click",function(t){t.preventDefault(),window.pf.stats.authors.getLeaderboard(!0)}),o("#build-valid-posts").on("click",function(t){t.preventDefault(),window.pf.stats.valid_posts.getLeaderboard(!0)}),window.pf.stats.failSafeGetJSON=function(t,o,s){function a(){return s(!1)}return jQuery.getJSON(t,function(t){return o(t)}).fail(function(){return console.log(" Request failed setting up retry in 15 seconds "),window.setTimeout(a,15e3)})},window.leaderboardInits={authors:!1,validPosts:!1},"authors"!==window.pf.location&&!jQuery("body").hasClass("pressforward_page_pf-tools")||(window.pf.stats.authors={endpoint:function(){return t.root+"pf/v1/stats/authors"},arguments:function(t){return window.pf.stats.authors.endpoint()+"?page="+t},pages:1,pagesFull:!1,leaderboard:{},pageFillerFunction:function(s){return window.pf.stats.failSafeGetJSON(window.pf.stats.authors.arguments(s),function(t){return console.log("PF Author Leaderboard Fill",t),console.log("PF Check: ",void 0!==t.length&&0===t.length),void 0!==t.length&&0===t.length?(window.pf.stats.authors.pagesFull=!0,console.log("PF Author Leaderboard Complete"),!0):(console.log("PF Author Leaderboard Fills in",t),jQuery.each(t,function(t,o){console.log("PF Author Leaderboard advancing to page ",s),window.pf.stats.authors.leaderboard.hasOwnProperty(t)?window.pf.stats.authors.leaderboard[t].count+=o.count:window.pf.stats.authors.leaderboard[t]=o}),!1)},window.pf.stats.authors.getLeaderboard)},getLeaderboard:function(t){if(t){if(window.leaderboardInits.authors)return"";window.leaderboardInits.authors=!0}return console.log("PF Author Page set",window.pf.stats.authors.pages),window.pf.stats.authors.pageFillerFunction(window.pf.stats.authors.pages).done(function(t){if(!1!==window.pf.stats.authors.pagesFull){var o,s,a=Object.keys(window.pf.stats.authors.leaderboard).sort(function(t,o){return window.pf.stats.authors.leaderboard[o].count-window.pf.stats.authors.leaderboard[t].count}),e=(console.log(a),0);for(o in a)a.hasOwnProperty(o)&&(s='<br/><li id="author-'+e+'"><strong>Name:</strong> '+(s=window.pf.stats.authors.leaderboard[a[o]]).name+"<li><strong>Count:</strong> "+s.count+"</li></li>",jQuery("#author-leaderboard ul").append(s),e++);return""}window.pf.stats.authors.pages=window.pf.stats.authors.pages+1,window.pf.stats.authors.getLeaderboard(!1)}),""}}),"stats"!==window.pf.location&&!jQuery("body").hasClass("pressforward_page_pf-tools")||(window.pf.stats.valid_posts={endpoint:function(){return t.root+"pf/v1/stats/pf_posted"},arguments:function(t){return window.pf.stats.valid_posts.endpoint()+"?page="+t},pages:1,pagesFull:!1,postCount:0,leaderboard:{},flesch_kincaid_score_total:0,pageFillerFunction:function(s){return window.pf.stats.failSafeGetJSON(window.pf.stats.valid_posts.arguments(s),function(t){return console.log("PF Valid Posts Leaderboard Fill",t),console.log("PF Check: ",void 0!==t.length&&0===t.length),void 0!==t.length&&0===t.length?(window.pf.stats.valid_posts.pagesFull=!0,console.log("PF Valid Posts Leaderboard Complete"),!0):(console.log("PF Valid Posts Leaderboard Fills in",t),jQuery.each(t,function(t,o){console.log("PF Valid Posts Leaderboard advancing to page ",s),window.pf.stats.valid_posts.leaderboard[o.ID]=o,window.pf.stats.valid_posts.flesch_kincaid_score_total+=o.flesch_kincaid_score,window.pf.stats.valid_posts.postCount+=1}),!1)},window.pf.stats.valid_posts.getLeaderboard)},getLeaderboard:function(t){if(t){if(window.leaderboardInits.validPosts)return"";window.leaderboardInits.validPosts=!0}return console.log("PF Valid Posts Page set",window.pf.stats.valid_posts.pages),window.pf.stats.valid_posts.pageFillerFunction(window.pf.stats.valid_posts.pages).done(function(t){if(console.log("Checking for next step of pages ",window.pf.stats.valid_posts.pages),!1===window.pf.stats.valid_posts.pagesFull)return window.pf.stats.valid_posts.pages=window.pf.stats.valid_posts.pages+1,window.pf.stats.valid_posts.getLeaderboard(!1);var o,s,a="<strong>Total PressForward Items Published:</strong> "+window.pf.stats.valid_posts.postCount+". ",a=(jQuery("#top-level").append(a),"<strong>Total WordCount:</strong> "+window.pf.stats.wordcount.total()+". "),e=(window.pf.stats.valid_posts.flesch_kincaid_score_avg=window.pf.stats.valid_posts.flesch_kincaid_score_total/window.pf.stats.valid_posts.postCount,jQuery("#top-level").append(a),window.pf.stats.sources.total()),n=Object.keys(e).sort(function(t,o){return e[o]-e[t]}),r=(console.log(n),0);for(o in n)n.hasOwnProperty(o)&&(s=e[n[o]],s='<br/><li id="source-'+r+'"><strong>Items from</strong> <a href="'+n[o]+'" target="_blank">'+n[o]+"</a>: "+s+"</li>",jQuery("#sources-leaderboard ul").append(s),r++);return""})}},window.pf.stats.wordcount={limits:[],count:0,results:{},setLimit:function(t,o){window.pf.stats.wordcount.limits.push({key:t,value:o})},pullPostsTogether:function(t){window.pf.stats.valid_posts.pagesFull||window.pf.stats.valid_posts.getLeaderboard(!1),window.pf.stats.wordcount.count=0,jQuery.each(window.pf.stats.valid_posts.leaderboard,function(t){window.pf.stats.wordcount.count+=window.pf.stats.valid_posts.leaderboard[t].wordcount}),void 0===t&&(t=(new Date).getTime()),window.pf.stats.wordcount.results[t]=JSON.parse(window.pf.stats.wordcount.count)},total:function(){return window.pf.stats.wordcount.pullPostsTogether("total"),window.pf.stats.wordcount.results.total}},window.pf.stats.sources={limits:[],count:0,results:{},resultObj:{},setLimit:function(t,o){window.pf.stats.sources.limits.push({key:t,value:o})},assemble:function(t){window.pf.stats.sources.count=0,window.pf.stats.sources.resultObj={},jQuery.each(window.pf.stats.valid_posts.leaderboard,function(t,o){o=o.source_link;void 0===window.pf.stats.sources.resultObj[o]?window.pf.stats.sources.resultObj[o]=1:window.pf.stats.sources.resultObj[o]+=1}),void 0===t&&(t=(new Date).getTime()),window.pf.stats.sources.results[t]=JSON.parse(JSON.stringify(window.pf.stats.sources.resultObj))},pullPostsTogether:function(t){window.pf.stats.valid_posts.pagesFull||window.pf.stats.valid_posts.getLeaderboard(!1),window.pf.stats.sources.assemble(t)},total:function(){return window.pf.stats.sources.pullPostsTogether("total"),window.pf.stats.sources.results.total}})})})}(jQuery);