"use strict";function pf_make_url_hashed(e){window.location.hash="#"+e}function assure_closed_menus(){jQuery(".dropdown li > *").on("click",function(){jQuery(".dropdown.open").removeClass("open")})}function trim_words(e,o){return e.split(/\s+/,o).join(" ")}function assure_next_obj(e,o,t){var r=jQuery("article:last-child").attr("tabindex");return 0!=o.length&&!o.is(":hidden")||(1==t?e+=1:--e,o=jQuery('article[tabindex="'+e+'"]')),(0==o.length||o.is(":hidden"))&&0<=e&&e<r&&(o=assure_next_obj(e,o,t)),!o.is(":hidden")&&o}function modalNavigator(e){e=parseInt(e);var o,t,r,n,i,a,l=jQuery('article[tabindex="'+e+'"]'),d=(jQuery(l).attr("id"),e-1),s=e+1,u=jQuery('article[tabindex="'+d+'"]'),c=jQuery('article[tabindex="'+s+'"]'),f=l.children("header").children("h1").children("a").attr("href"),u=assure_next_obj(d,u,0),c=assure_next_obj(s,c,1);0!=jQuery(u)&&jQuery(u).is("*")&&(r='<h5 class="prev_title">Previous: <a href="'+(o=jQuery(u).children("header").children("h1").children("a").attr("href"))+'" role="button" class="modal-nav" data-dismiss="modal" data-toggle="modal" data-backdrop="false">'+(t=jQuery(u).children("header").children("h1").text())+"</a></h5>",r+='<p class="prev_source_title">'+jQuery(u).children("header").children("p.source_title").text()+"</p>",r+='<p class="prev_author">'+jQuery(u).children("header").children("div.feed-item-info-box").children("span.item_authors").text()+"</p>",r+='<p class="prev_excerpt">'+trim_words(jQuery(u).children("div.content").children("div.item_excerpt").text(),20)+"</p>",r+='<p class="prev_date">'+jQuery(u).children("footer").children("p.pubdate").text()+"</p>",jQuery(f+" div.modal-body-row div.modal-sidebar div.goPrev").html(r),jQuery(f+" div.mobile-goPrev").html('<i class="icon-arrow-left"></i> <a href="'+o+'" role="button" data-bs-dismiss="modal" class="mobile-modal-navlink modal-nav">'+t+"</a> ")),0!=jQuery(c)&&jQuery(c).is("*")&&(a='<h5 class="next_title">Next: <a href="'+(n=jQuery(c).children("header").children("h1").children("a").attr("href"))+'" role="button" class="modal-nav" data-dismiss="modal" data-toggle="modal" data-backdrop="false">'+(i=jQuery(c).children("header").children("h1").text())+"</a></h5>",a+='<p class="next_source_title">'+jQuery(c).children("header").children("p.source_title").text()+"</p>",a+='<p class="next_author">'+jQuery(c).children("header").children("div.feed-item-info-box").children("span.item_authors").text()+"</p>",a+='<p class="next_excerpt">'+trim_words(jQuery(c).children("div.content").children("div.item_excerpt").text(),20)+"</p>",a+='<p class="next_date">'+jQuery(c).children("footer").children("p.pubdate").text()+"</p>",jQuery(f+" div.modal-body-row div.modal-sidebar div.goNext").html(a),jQuery(f+" div.mobile-goNext").html('&nbsp;| <a href="'+n+'" role="button" class="mobile-modal-navlink modal-nav" data-bs-dismiss="modal">'+i+'</a> <i class="icon-arrow-right"></i>'))}function commentPopModal(){jQuery(".pfmodal").on("shown.bs.modal",function(e){var o=jQuery(this),t=o.closest("article");o.closest("article").attr("id"),t.attr("pf-item-id"),t.attr("pf-post-id"),t.attr("pf-item-post-id");jQuery("#ef-comments_wrapper").remove()}),jQuery(".pfmodal").on("hide.bs.modal",function(e){jQuery("#ef-comments_wrapper").remove()})}function reshowModal(){jQuery(".pfmodal").on("show.bs.modal",function(e){pf_make_url_hashed(jQuery(this).attr("id"))}),jQuery(".pfmodal").on("shown.bs.modal",function(e){var o=jQuery(this).attr("id");document.body.style.overflow="hidden";jQuery("#"+o+".pfmodal").css({display:"block",position:"fixed",top:"0",right:"0",bottom:"100%",left:"0",margin:"0",width:"100%",height:"100%",overflow:"hidden","z-index":"9999"}).load(hide_non_modals())})}function hide_non_modals(){jQuery("#wpadminbar").hide(),jQuery("#adminmenuback").hide(),jQuery("#adminmenuwrap").hide(),jQuery("#wpfooter").hide()}function reviewModal(){jQuery(".comment-modal").on("shown.bs.modal",function(e){var o=jQuery(this),t=o.attr("id"),r=o.closest(".feed-item").attr("pf-item-post-id");jQuery.post(ajaxurl,{action:"pf_ajax_get_comments",id_for_comments:r},function(e){jQuery("#"+t+".comment-modal .modal-body").html(e)}),setTimeout(function(){var e=o.find(".modal-body-row").height();o.find(".modal-body-row .modal-body").height(e)},100),modalNavigator(o.parent().attr("tabindex"))})}function hideModal(){jQuery(".pfmodal").on("hide.bs.modal",function(e){jQuery(".pfmodal .modal-comments").html(""),"function"==typeof editorialCommentReply&&editorialCommentReply.close(),jQuery("#wpadminbar").show(),jQuery("#adminmenuback").show(),jQuery("#adminmenuwrap").show(),jQuery("#wpfooter").show(),document.body.style.overflow="visible",pf_make_url_hashed("ready")})}function commentModal(){jQuery(".pfmodal").on("show.bs.modal",function(e){var o=jQuery(this),t=o.parent("article").attr("id"),r=(o.attr("pf-item-id"),o.attr("pf-post-id"),o.parent().attr("pf-item-post-id"));jQuery.post(ajaxurl,{action:"pf_ajax_get_comments",id_for_comments:r},function(e){jQuery("#"+t+".comment-modal .modal-body").html(e)})})}function PFBootstrapInits(){jQuery(".dropdown-toggle").on("click",function(){jQuery(this).closest(".dropdown").toggleClass("open")}),jQuery(".nom-to-archive").tooltip({placement:"top",trigger:"hover",title:"Item"}),jQuery(".nom-to-draft").tooltip({placement:"top",trigger:"hover",title:"Item"}),jQuery(".nominate-now").tooltip({placement:"top",trigger:"hover",title:"Nominate"}),jQuery(".star-item").tooltip({placement:"top",trigger:"hover",title:"Star"}),jQuery(".itemCommentModal").tooltip({placement:"top",trigger:"hover",title:"Comment"}),jQuery(".nom-count").tooltip({placement:"top",trigger:"hover",title:"Nomination Count"}),jQuery(".pf-amplify").tooltip({placement:"top",trigger:"hover",title:"Amplify"}),jQuery(".meta_form_modal-button").tooltip({placement:"top",trigger:"hover",title:"Edit Metadata"}),jQuery(".itemInfobutton").popover({html:!0,title:"",container:".icon-info-sign",content:function(){var e=jQuery(this).attr("data-target"),o='<div class="feed-item-info-box">';return o+=jQuery("#info-box-"+e).html(),o+="</div>",console.log("Popover assembled"),o}}).on("click",function(){jQuery(".popover").addClass(jQuery(this).data("class"))}),jQuery(".modal.pfmodal").on("hide",function(e){jQuery(".itemInfobutton").popover("hide")}),jQuery(".modal.pfmodal").on("show",function(e){jQuery(".itemInfobutton").popover("hide")}),jQuery(".info-box-popover").on("click",function(e){e.stopPropagation()}),jQuery(".itemInfobutton").on("click",function(e){e.stopPropagation()}),jQuery(document).on("click",function(e){jQuery(".itemInfobutton").popover("hide")}),attach_menu_on_scroll_past(),assure_closed_menus()}function attach_menu_on_scroll_past(){jQuery(window).on("scroll",function(){var e,o;90<window.pageYOffset?(jQuery(".pf_container .display").addClass("nav-fix"),jQuery(".pf_container #feed-folders").addClass("right-bar-fix"),jQuery(".pf_container #tools").addClass("right-bar-fix"),jQuery("#fullscreenfeed").appendTo(".display .pf-btns"),jQuery("#feeds-search").insertAfter(".display .pf-btns").addClass("pull-left search-in-bar"),jQuery("#feeds-search > *").addClass("pull-left"),jQuery("#feeds-search > label").hide(),e=jQuery(".pf_container").innerWidth(),o=jQuery(".pf_container").offset(),jQuery(".nav-fix").width(e-20).offset({left:o.left})):(jQuery(".pf_container .display").removeClass("nav-fix"),jQuery(".pf_container #feed-folders").removeClass("right-bar-fix"),jQuery(".pf_container #tools").removeClass("right-bar-fix"),jQuery("#fullscreenfeed").insertAfter("#h-after"),jQuery("#feeds-search").appendTo("#app-banner").removeClass("pull-left search-in-bar"),jQuery("#feeds-search > *").removeClass("pull-left"),jQuery(".pf_container .display").width("auto"))}),jQuery(window).on("resize",function(){var e=jQuery("#entries").innerWidth();jQuery(".nav-fix").width(e-80),jQuery("#adminmenuback").width()})}function detect_view_change(){jQuery(".pf_container").on("click",".pf-top-menu-selection.display-state",function(e){var o=jQuery(this).attr("id");console.log(o),jQuery.post(ajaxurl,{action:"pf_ajax_retain_display_setting",pf_read_state:o},function(e){})});jQuery(".pressforward #wpbody").on("click",".list .amplify-group .pf-amplify",function(e){var o=jQuery(this),t=o.parents("article"),r=t.height(),n=o.closest(".dropdown");o.hasClass("amplify-down")?(o.removeClass("amplify-down"),jQuery(t).removeClass("show-overflow"),jQuery(t).css("height",""),jQuery(n).removeClass("open")):(o.addClass("amplify-down"),jQuery(t).addClass("show-overflow"),jQuery(t).height(r),jQuery(n).addClass("open"),0)}),jQuery(".pressforward #wpbody").on("click",".list div:not(.amplify-group.open)",function(e){jQuery(".amplify-group.open")}),jQuery(".pressforward #wpbody").on("click",".grid .amplify-group .pf-amplify",function(e){var o=jQuery(this),t=o.parents("article"),r=(t.height(),t.find("header"),o.closest(".dropdown"));t.hasClass("amplify-down")?(t.removeClass("amplify-down"),r.removeClass("open")):(t.addClass("amplify-down"),r.addClass("open"),0)}),jQuery(".pressforward #wpbody").on("click",".grid div:not(.amplify-group.open)",function(e){})}function removeURLParameter(e,o){var t=e.split("?");if(2<=t.length){for(var r=encodeURIComponent(o)+"=",n=t[1].split(/[&;]/g),i=n.length;0<i--;)-1!==n[i].lastIndexOf(r,0)&&n.splice(i,1);return e=t[0]+"?"+n.join("&")}return e}console.log("Waiting for load."),jQuery(window).on("load",function(){var r=jQuery(".pfmodal");jQuery(".pf-loader").delay(300).fadeOut("slow",function(){var o,t,e;console.log("Load complete."),jQuery(".pf_container").fadeIn("slow"),window.location.hash.indexOf("#")<0?window.location.hash="#ready":0<=window.location.hash.toLowerCase().indexOf("modal")&&(e=window.location.hash,jQuery(e).hasClass("in")||(t=jQuery(e),o=t.find(".close"),new bootstrap.Modal(t).show(o))),jQuery(window).on("hashchange",function(){var e;"#ready"==window.location.hash&&jQuery(".modal").modal("hide"),0<=window.location.hash.toLowerCase().indexOf("modal")&&(e=window.location.hash,jQuery(e).hasClass("in")||(t=jQuery(e),o=t.find(".close"),new bootstrap.Modal(t).show(o),r.each(function(){var e=bootstrap.Modal.getInstance(this);e&&e.hide()})))})})}),jQuery(window).on("load",function(){var e;jQuery("#gogrid").on("click",function(e){e.preventDefault(),jQuery("div.pf_container").removeClass("list").addClass("grid"),jQuery("#gogrid").addClass("unset"),jQuery("#golist").removeClass("unset"),jQuery(".feed-item").each(function(e){var o=jQuery(this).attr("id");jQuery("#"+o+" footer .actions").appendTo("#"+o+" header")})}),jQuery("#golist").on("click",function(e){e.preventDefault(),jQuery("div.pf_container").removeClass("grid").addClass("list"),jQuery("#golist").addClass("unset"),jQuery("#gogrid").removeClass("unset"),jQuery(".feed-item").each(function(e){var o=jQuery(this).attr("id");jQuery("#"+o+" header .actions").appendTo("#"+o+" footer")})}),jQuery("#gomenu").on("click",function(e){e.preventDefault(),jQuery("#feed-folders").hide("slide",{direction:"right",easing:"linear"},150)}),jQuery("#gomenu").on("click",function(e){pf.toggler(e,this,function(e){var o=jQuery("#tools");jQuery("div.pf_container").removeClass("full"),jQuery("#feed-folders").hide("slide",{direction:"right",easing:"linear"},150),jQuery(o).show("slide",{direction:"right",easing:"linear"},150)},function(){var e=jQuery("#tools");jQuery(e).hide("slide",{direction:"right",easing:"linear"},150),jQuery("div.pf_container").addClass("full")})}),jQuery("#gofolders").on("click",function(e){e.preventDefault(),jQuery("#tools").hide("slide",{direction:"right",easing:"linear"},150)}),jQuery("#gofolders").on("click",function(e){pf.toggler(e,this,function(e){var o=jQuery("#feed-folders");jQuery("div.pf_container").removeClass("full"),jQuery(o).show("slide",{direction:"right",easing:"linear"},150)},function(){var e=jQuery("#feed-folders");jQuery(e).hide("slide",{direction:"right",easing:"linear"},150),jQuery("div.pf_container").addClass("full")})}),jQuery("#feed-folders .folder").on("click",function(e){e.preventDefault();var o=jQuery(this).attr("href"),t=window.location.href;t=removeURLParameter(t=t.replace("#","&"),"folder"),t=removeURLParameter(t,"feed"),-1<(t=removeURLParameter(t,"ready")).indexOf("?")?t+="&folder="+o:t+="?folder="+o,window.location.href=t}),jQuery("#feed-folders .feed").on("click",function(e){e.preventDefault();var o=jQuery(this).children("a").attr("href"),t=window.location.href;t=removeURLParameter(t=t.replace("#","&"),"folder"),t=removeURLParameter(t,"feed"),-1<(t=removeURLParameter(t,"ready")).indexOf("?")?t+="&feed="+o:t+="?feed="+o,window.location.href=t}),jQuery(".scroll-toggler").on("click",function(e){e.preventDefault();var o=jQuery(this).attr("id"),t="true";console.log(o),"gopaged"==o&&(t="false"),jQuery.post(ajaxurl,{action:"pf_ajax_user_setting",pf_user_setting:"pf_user_scroll_switch",setting:t},function(e){"1"!=html_entity_decode(jQuery(e).find("response_data").text())?alert("PressForward has lost its connection to your server. Reload page and try again."):location.reload()})}),jQuery("#deletefeedarchive").on("click",function(e){e.preventDefault(),jQuery(".loading-top").show(),jQuery.post(ajaxurl,{action:"reset_feed"},function(e){jQuery(".loading-top").hide(),jQuery("#errors").html(e)})}),0!=jQuery(".list").length&&(e=jQuery(".list article"),jQuery.each(e,function(e,o){var t=jQuery(this).attr("id");jQuery("#"+t+" header .actions").appendTo("#"+t+" footer")})),jQuery(".pf_container").on("click","#showMyNominations",function(e){e.preventDefault(),window.open("?page=pf-menu&by=nominated","_self")}),jQuery(".pf_container").on("click","#showMyHidden",function(e){e.preventDefault(),window.open("?page=pf-menu&reveal=no_hidden","_self")}),jQuery(".pf_container").on("click","#showUnread",function(e){e.preventDefault(),window.open("?page=pf-menu&reveal=unread","_self")}),jQuery(".pf_container.pf-all-content").on("click","#showDrafted",function(e){e.preventDefault(),window.open("?page=pf-menu&reveal=drafted","_self")}),jQuery(".pf_container").on("click","#showMyStarred",function(e){e.preventDefault(),window.open("?page=pf-menu&by=starred","_self")}),jQuery(".pf_container").on("click","#showNormal",function(e){e.preventDefault(),window.open("?page=pf-menu","_self")}),jQuery(".pf_container").on("click","#showNormalNominations",function(e){e.preventDefault(),window.open("?page=pf-review","_self")}),jQuery(".pf_container").on("click",".remove-nom-this-prompt",function(e){e.preventDefault(),jQuery("article.nominate-this-preview").remove(),jQuery.post(ajaxurl,{action:"pf_ajax_user_setting",pf_user_setting:"have_you_seen_nominate_this",setting:"yes"},function(e){html_entity_decode(jQuery(e).find("response_data").text())}),jQuery(this).is("[href]")&&window.open("?page=pf-tools","_self")}),reshowModal(),reviewModal(),hideModal(),commentPopModal(),PFBootstrapInits(),detect_view_change()});