function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function get_html_translation_table(e,t){var a,r={},o={},l={},i={};if(l[0]="HTML_SPECIALCHARS",l[1]="HTML_ENTITIES",i[0]="ENT_NOQUOTES",i[2]="ENT_COMPAT",i[3]="ENT_QUOTES",l=isNaN(e)?e?e.toUpperCase():"HTML_SPECIALCHARS":l[e],e=isNaN(t)?t?t.toUpperCase():"ENT_COMPAT":i[t],"HTML_SPECIALCHARS"!==l&&"HTML_ENTITIES"!==l)throw new Error("Table: "+l+" not supported");for(a in r[38]="&amp;","HTML_ENTITIES"===l&&(r[160]="&nbsp;",r[161]="&iexcl;",r[162]="&cent;",r[163]="&pound;",r[164]="&curren;",r[165]="&yen;",r[166]="&brvbar;",r[167]="&sect;",r[168]="&uml;",r[169]="&copy;",r[170]="&ordf;",r[171]="&laquo;",r[172]="&not;",r[173]="&shy;",r[174]="&reg;",r[175]="&macr;",r[176]="&deg;",r[177]="&plusmn;",r[178]="&sup2;",r[179]="&sup3;",r[180]="&acute;",r[181]="&micro;",r[182]="&para;",r[183]="&middot;",r[184]="&cedil;",r[185]="&sup1;",r[186]="&ordm;",r[187]="&raquo;",r[188]="&frac14;",r[189]="&frac12;",r[190]="&frac34;",r[191]="&iquest;",r[192]="&Agrave;",r[193]="&Aacute;",r[194]="&Acirc;",r[195]="&Atilde;",r[196]="&Auml;",r[197]="&Aring;",r[198]="&AElig;",r[199]="&Ccedil;",r[200]="&Egrave;",r[201]="&Eacute;",r[202]="&Ecirc;",r[203]="&Euml;",r[204]="&Igrave;",r[205]="&Iacute;",r[206]="&Icirc;",r[207]="&Iuml;",r[208]="&ETH;",r[209]="&Ntilde;",r[210]="&Ograve;",r[211]="&Oacute;",r[212]="&Ocirc;",r[213]="&Otilde;",r[214]="&Ouml;",r[215]="&times;",r[216]="&Oslash;",r[217]="&Ugrave;",r[218]="&Uacute;",r[219]="&Ucirc;",r[220]="&Uuml;",r[221]="&Yacute;",r[222]="&THORN;",r[223]="&szlig;",r[224]="&agrave;",r[225]="&aacute;",r[226]="&acirc;",r[227]="&atilde;",r[228]="&auml;",r[229]="&aring;",r[230]="&aelig;",r[231]="&ccedil;",r[232]="&egrave;",r[233]="&eacute;",r[234]="&ecirc;",r[235]="&euml;",r[236]="&igrave;",r[237]="&iacute;",r[238]="&icirc;",r[239]="&iuml;",r[240]="&eth;",r[241]="&ntilde;",r[242]="&ograve;",r[243]="&oacute;",r[244]="&ocirc;",r[245]="&otilde;",r[246]="&ouml;",r[247]="&divide;",r[248]="&oslash;",r[249]="&ugrave;",r[250]="&uacute;",r[251]="&ucirc;",r[252]="&uuml;",r[253]="&yacute;",r[254]="&thorn;",r[255]="&yuml;"),"ENT_NOQUOTES"!==e&&(r[34]="&quot;"),"ENT_QUOTES"===e&&(r[39]="&#39;"),r[60]="&lt;",r[62]="&gt;",r)r.hasOwnProperty(a)&&(o[String.fromCharCode(a)]=r[a]);return o}function html_entity_decode(e,t){var a,r={},o="",l="",l=e.toString();if(!1===(r=get_html_translation_table("HTML_ENTITIES",t)))return!1;for(o in delete r["&"],r["&"]="&amp;",r)a=r[o],l=l.split(a).join(o);return l=l.split("&#039;").join("'")}function allContentModal(){jQuery(".pressforward_page_pf-all-content").on("shown",".pfmodal.modal",function(e){document.body.style.overflow="hidden";var r=jQuery(this),o=(r.attr("id"),r.attr("pf-item-id")),t=r.attr("pf-post-id"),a=r.parent().attr("tabindex"),l=(modalNavigator(a),jQuery("#"+o+" #modal-body-"+o+" .main-text").html()),a=jQuery("#"+o+" #item_link_"+o).val(),i=jQuery("#"+o+" #item_author_"+o).val(),d=r.attr("pf-readability-status"),n=jQuery("#"+o+" #item_tags_"+o).val(),u=jQuery.trim(jQuery("#pf_nomination_nonce").val()),m=jQuery("#"+o+" i.schema-read:first");m.hasClass("marked-read")?console.log("Already marked read",m,o):(console.log("Attempting to mark read",m,o),m.click()),jQuery.post(ajaxurl,{action:"pf_ajax_get_comments",id_for_comments:t},function(e){jQuery("#"+o+" #modal-"+o+" .modal-comments").html(e)}),1!=d&&"opml-feed"!=n&&(jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .readability-wait").html("<h2>Attempting to retrieve full article.</h2>"),jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .main-text").hide(),jQuery.post(ajaxurl,{action:"make_it_readable",read_item_id:o,url:a,content:escape(l),post_id:t,authorship:i,pf_nomination_nonce:u,force:"noforce"},function(e){var t,a=html_entity_decode(jQuery(e).find("response_data").text()),e=jQuery(e).find("readable_status").text();"readable"!=e?"secured"==e?(alert("The content cannot be retrieved. The post may be on a secure page or it may have been removed."),jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .main-text").html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t),r.attr("pf-readability-status",1)):"already_readable"==e?(jQuery("#"+o+" #modal-body-"+o+" .main-text").html(unescape(l)),r.attr("pf-readability-status",1)):(jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .main-text").html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t)):r.attr("pf-readability-status",1),jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .readability-wait").hide(),jQuery("#"+o+" #modal-"+o+" #modal-body-"+o+" .main-text").show()}))})}function modalReadReset(){jQuery(".pressforward_page_pf-all-content .pf_container").on("click",".modal-readability-reset",function(e){e.preventDefault();var e=jQuery(this),r=e.attr("pf-modal-id"),o=e.attr("pf-item-id"),e=e.attr("pf-post-id"),l=jQuery("#"+o+" #modal-body-"+o).html(),t=jQuery("#"+o+" #item_link_"+o).val(),a=jQuery("#"+o+" #item_author_"+o).val(),i=jQuery.trim(jQuery("#pf_nomination_nonce").val());jQuery("#"+o+" #modal-"+o+" #modal-body-"+o).html("Attempting to retrieve full article."),jQuery.post(ajaxurl,{action:"make_it_readable",read_item_id:o,url:t,content:escape(l),post_id:e,authorship:a,pf_nomination_nonce:i,force:"force"},function(e){jQuery(e).find("response_data").text();var t,a=html_entity_decode(jQuery(e).find("response_data").text()),e=jQuery(e).find("readable_status").text();"readable"!=e?"secured"==e?(alert("The content cannot be retrieved. The post may be on a secure page or it may have been removed."),jQuery("#"+o+" #modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t),jQuery(r).attr("pf-readability-status",1)):"already_readable"==e?(jQuery("#"+o+" #modal-"+o+" #modal-body-"+o).html(unescape(l)),jQuery(r).attr("pf-readability-status",1)):(jQuery("#"+o+" #modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t)):(jQuery("#"+o+" #modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t),jQuery(r).attr("pf-readability-status",1))})})}function modalNomReadReset(){jQuery(".pressforward_page_pf-review .pf_container").on("click",".modal-readability-reset",function(e){e.preventDefault();var e=jQuery(this),r=e.attr("pf-modal-id"),o=e.attr("pf-item-id"),e=e.attr("pf-post-id"),l=jQuery("#"+e+" #modal-body-"+o).html(),t=jQuery("#"+e+" #permalink_"+o).val(),a=jQuery("#"+e+" #authors_"+o).val(),i=jQuery.trim(jQuery("#pf_nomination_nonce").val());jQuery("#"+e+" #modal-"+o+" #modal-body-"+o).html("Attempting to retrieve full article."),jQuery.post(ajaxurl,{action:"make_it_readable",read_item_id:o,url:t,content:escape(l),post_id:e,authorship:a,pf_nomination_nonce:i,force:"force"},function(e){jQuery(e).find("response_data").text();var t,a=html_entity_decode(jQuery(e).find("response_data").text()),e=jQuery(e).find("readable_status").text();"readable"!=e?"secured"==e?(alert("The content cannot be retrieved. The post may be on a secure page or it may have been removed."),jQuery("#modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t),jQuery(r).attr("pf-readability-status",1)):"already_readable"==e?(jQuery("#modal-"+o+" #modal-body-"+o).html(unescape(l)),jQuery(r).attr("pf-readability-status",1)):(jQuery("#modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t)):(jQuery("#modal-"+o+" #modal-body-"+o).html(a),t=escapeHtml(a),jQuery("#item_content_"+o).attr("value",t),jQuery(r).attr("pf-readability-status",1))})})}jQuery(window).on("load",function(){allContentModal(),modalReadReset(),modalNomReadReset()});