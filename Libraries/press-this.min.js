!function(I,q){q.wp=q.wp||{},q.wp.pressThis=new function(){var r,l,d,e,c=I(q),p=I(document),u=!1,h=!1,s=q.wpPressThisConfig||{},f=q.wpPressThisData||{},t=128,g=!1,m=[],v="is-off-screen",C="is-hidden",b=v+" "+C,a=/iPad|iPod|iPhone/.test(q.navigator.userAgent),x=I("#pressthis"),n=x[0],i=600,o=0,y=void 0!==(e=document.documentElement.style).transition?"transitionend":void 0!==e.WebkitTransition&&"webkitTransitionEnd";function w(e){return e&&q.pressThisL10n?q.pressThisL10n[e]||e:e||""}function k(e){return e=I.trim(e||""),/^(?:https?:)?\/\//.test(e)?(e=wp.sanitize.stripTags(e)).replace(/["\\]+/g,""):""}function T(e){var t;r&&!r.isHidden()||(e="reset"===e||o&&o>n.value.length,n.style.height,e?(t=q.pageYOffset,n.style.height="auto",n.style.height=Math.max(n.scrollHeight,i)+"px",q.scrollTo(q.pageXOffset,t)):parseInt(n.style.height,10)<n.scrollHeight&&(n.style.height=n.scrollHeight+"px"),o=n.value.length)}function E(e){var t=q.tinymce.util.VK,s=e.keyCode;s<=47&&s!==t.SPACEBAR&&s!==t.ENTER&&s!==t.DELETE&&s!==t.BACKSPACE&&s!==t.UP&&s!==t.LEFT&&s!==t.DOWN&&s!==t.UP||91<=s&&s<=93||112<=s&&s<=123||144===s||145===s||O(s)}function O(e){var t,s,a,n=function(){if(!r)return!1;var e,t,s,a=r.selection.getNode();if(r.wp&&r.wp.getView&&(t=r.wp.getView(a)))s=t.getBoundingClientRect();else{e=r.selection.getRng();try{s=e.getClientRects()[0]}catch(e){}s=s||a.getBoundingClientRect()}return!!s.height&&s}(),i=q.tinymce.util.VK;n&&(s=(t=n.top+r.iframeElement.getBoundingClientRect().top)+n.height,t-=50,s+=65,(a=c.height())<n.height||(t<0&&(e===i.UP||e===i.LEFT||e===i.BACKSPACE)?q.scrollTo(q.pageXOffset,t+q.pageYOffset):a<s&&q.scrollTo(q.pageXOffset,s+q.pageYOffset-a)))}function _(){var e=I("#title-container");return e.find("img.emoji").each(function(){var e=I(this);e.replaceWith(I("<span>").text(e.attr("alt")))}),wp.sanitize.stripTagsAndEncodeText(e.text())}function A(){var a=I("#pressthis-form"),n=I('<input type="hidden" name="post_category[]" value="">');r&&r.save(),I("#post_title").val(_()),q.tagBox&&I("div.tagsdiv").each(function(){q.tagBox.flushTags(this,!1,1)}),I(".categories-select .category").each(function(e,t){var s=I(t);s.hasClass("selected")&&a.append(n.clone().val(s.attr("data-term-id")||""))})}function D(e){var t;u=!1,I(".spinner").addClass("is-active"),I(".post-actions button").attr("disabled","disabled"),"publish"===e&&I("#post_status").val("publish"),A(),t=I("#pressthis-form").serialize(),I.ajax({type:"post",url:q.ajaxurl,data:t}).always(function(){I(".spinner").removeClass("is-active"),I(".post-actions button").removeAttr("disabled"),I("div.alerts").empty(),I(".publish-button").removeClass("is-saving")}).done(function(t){if(t.success){if(t.data.redirect)if(q.opener&&(s.redirInParent||t.data.force))try{q.opener.location.href=t.data.redirect,q.setTimeout(function(){q.self.close()},200)}catch(e){q.location.href=t.data.redirect}else q.location.href=t.data.redirect}else R(t.data.errorMessage)}).fail(function(){R(w("serverError"))})}function P(){var e,t=I("#new-category").val();t&&(e={action:"press-this-add-category",post_id:I("#post_ID").val()||0,name:t,new_cat_nonce:I("#_ajax_nonce-add-category").val()||"",parent:I("#new-category-parent").val()||0},I.post(q.ajaxurl,e,function(e){var a,n,i;e.success?(i=I("ul.categories-select"),I.each(e.data,function(e,t){var s=I("<li>").append(I('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",t.term_id).text(t.name));t.parent?(n&&n.length||(a=i.find('div[data-term-id="'+t.parent+'"]').parent(),(n=a.find("ul.children:first")).length||(n=I('<ul class="children">').appendTo(a))),n.prepend(s)):i.prepend(s),s.focus()}),H()):R(e.data.errorMessage)}))}function B(e,t){var s=t?"is-error":"is-notice";I(".editor-wrapper div.alerts").append(I('<p class="alert '+s+'">').text(e))}function R(e){B(e,!0)}function j(){var c=0;l=I("ul.media-list"),d=I('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>'),f._embeds&&I.each(f._embeds,function(e,t){var s="",a=d.clone().addClass("is-embed");-1<(t=k(t)).indexOf("youtube.com/")?s="https://i.ytimg.com/vi/"+t.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg":-1<t.indexOf("youtu.be/")?s="https://i.ytimg.com/vi/"+t.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg":-1<t.indexOf("dailymotion.com")?s=t.replace("/video/","/thumbnail/video/"):-1<t.indexOf("soundcloud.com")||t.indexOf("twitter.com"),a.attr("data-wp-src",t).find("span").text(w("suggestedEmbedAlt").replace("%d",e+1)),s&&a.css("background-image","url("+s+")"),l.append(a),c++}),f._images&&I.each(f._images,function(n,i){var o,r=new Image;i=k(i),o=i.replace(/^(http[^\?]+)(\?.*)?$/,"$1"),o=-1<i.indexOf("files.wordpress.com/")?o.replace(/\?.*$/,"")+"?w="+t:-1<i.indexOf("gravatar.com/")?o.replace(/\?.*$/,"")+"?s="+t:i,r.onload=function(){var e,t,s,a;r.width&&r.width<256||r.height&&r.height<128||(e=i,t=o,s=n,(a=d.clone().addClass("is-image")).attr("data-wp-src",e).css("background-image","url("+t+")").find("span").text(w("suggestedImgAlt").replace("%d",s+1)),l.append(a))},r.src=i,c++}),c&&I(".media-list-container").addClass("has-media")}function L(){h=!1,I(".options").removeClass("open").addClass("closed"),I(".options-panel-back").addClass(C),I(".press-this-actions, #scanbar").removeClass(C),I(".options-panel").addClass(v).one(y,function(){I(this).addClass(C),I(".post-options").removeClass(b),I(".setting-modal").addClass(b)})}function N(){I(".categories-select").on("click.press-this keydown.press-this",function(e){var t,s=I(e.target);if(s.is("div.category")){if("keydown"===e.type&&32!==e.keyCode)return;(t=s).hasClass("selected")?t.removeClass("selected").attr("aria-checked","false"):t.addClass("selected").attr("aria-checked","true"),e.preventDefault()}})}function S(){I(".split-button").removeClass("is-open"),I(".split-button-toggle").attr("aria-expanded","false")}function $(){f.hasData&&I("#scanbar").hide(),j(),f.errors&&I.each(f.errors,function(e,t){R(t)}),q.tagBox&&q.tagBox.init(),a&&I(document.body).css("cursor","pointer")}function z(){var s,a,n,e,i,t,o=I(".split-button");return p.on("tinymce-editor-init",function(e,t){(r=t).on("nodechange",function(){g=!0}),r.on("focus",function(){S()}),r.on("show",function(){setTimeout(function(){r.execCommand("wpAutoResize")},300)}),r.on("hide",function(){setTimeout(function(){T("reset")},100)}),r.on("keyup",E),r.on("undo redo",O)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(e){var t,s,a,n;"click"!==e.type&&13!==e.keyCode||(t=I(this),s="",a=k(t.attr("data-wp-src")||""),n=k(f.u),s=t.hasClass("is-image")?'<a href="'+(n=n||a)+'"><img class="alignnone size-full" src="'+a+'" alt="" /></a>':"[embed]"+a+"[/embed]",r&&!r.isHidden()?g?r.execCommand("mceInsertContent",!1,s):r.setContent("<p>"+s+"</p>"+r.getContent()):q.QTags&&q.QTags.insertContent(s))}).on("click.press-this",function(e){I(e.target).closest("button").hasClass("split-button-toggle")||S()}),I(".post-actions").on("click.press-this",function(e){var t,s=I(e.target).closest("button");s.length&&(s.hasClass("draft-button")?(I(".publish-button").addClass("is-saving"),D("draft")):s.hasClass("publish-button")?(s.addClass("is-saving"),q.history.replaceState&&(t=q.location.href,t+=-1!==t.indexOf("?")?"&":"?",t+="wp-press-this-reload=true",q.history.replaceState(null,null,t)),D("publish")):s.hasClass("preview-button")?(A(),q.opener&&q.opener.focus(),I("#wp-preview").val("dopreview"),I("#pressthis-form").attr("target","_blank").submit().attr("target",""),I("#wp-preview").val("")):s.hasClass("standard-editor-button")?(I(".publish-button").addClass("is-saving"),I("#pt-force-redirect").val("true"),D("draft")):s.hasClass("split-button-toggle")&&(o.hasClass("is-open")?(o.removeClass("is-open"),s.attr("aria-expanded","false")):(o.addClass("is-open"),s.attr("aria-expanded","true"))))}),s=I(".post-options"),a=I(".post-option"),n=I(".setting-modal"),e=I(".modal-close"),a.on("click",function(){var e=I(this).index(),t=n.eq(e);s.addClass(v).one(y,function(){I(this).addClass(C)}),t.removeClass(b).one(y,function(){I(this).find(".modal-close").focus()})}),e.on("click",function(){var e=I(this).parent(),t=e.index();s.removeClass(b),e.addClass(v),y?e.one(y,function(){I(this).addClass(C),a.eq(t-1).focus()}):setTimeout(function(){e.addClass(C),a.eq(t-1).focus()},350)}),i=I("#title-container"),t=I(".post-title-placeholder"),i.on("focus",function(){t.addClass("is-hidden")}).on("blur",function(){i.text()||i.html()||t.removeClass("is-hidden")}).on("keyup",function(){u=!0}).on("paste",function(e){var t,s,a=e.originalEvent.clipboardData||q.clipboardData;if(a){try{(t=a.getData("Text")||a.getData("text/plain"))&&(t=I.trim(t.replace(/\s+/g," ")),q.getSelection?(s=q.getSelection().getRangeAt(0))&&(s.collapsed||s.deleteContents(),s.insertNode(document.createTextNode(t))):document.selection&&(s=document.selection.createRange())&&(s.text=t))}catch(e){}e.preventDefault()}u=!0,setTimeout(function(){i.text(_())},50)}),(i.text()||i.html())&&t.addClass("is-hidden"),N(),I(".options").on("click.press-this",function(){I(this).hasClass("open")?L():(h=!0,I(".options").removeClass("closed").addClass("open"),I(".press-this-actions, #scanbar").addClass(C),I(".options-panel-back").removeClass(C),I(".options-panel").removeClass(b).one(y,function(){I(".post-option:first").focus()}))}),I(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var e=document.activeElement,t=I(e);!h||!e||t.hasClass("options-panel-back")||"BODY"!==e.nodeName&&(t.closest(".options-panel").length||t.closest(".options").length)||L()},50)}),I("#post-formats-select input").on("change",function(){var e=I(this);e.is(":checked")&&I("#post-option-post-format").text(I('label[for="'+e.attr("id")+'"]').text()||"")}),c.on("beforeunload.press-this",function(){if(u||r&&r.isDirty())return w("saveAlert")}).on("resize.press-this",function(){r&&!r.isHidden()||T("reset")}),I("button.add-cat-toggle").on("click.press-this",function(){var e=I(this);e.toggleClass("is-toggled"),e.attr("aria-expanded","false"===e.attr("aria-expanded")?"true":"false"),I(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")}),I("button.add-cat-submit").on("click.press-this",P),I(".categories-search").on("keyup.press-this",function(){var s=I(this).val().toLowerCase()||"";/[\x20-\xFF]+/.test(s)&&s.length<2||(I.each(m,function(e,t){t.node.removeClass("is-hidden searched-parent")}),s&&I.each(m,function(e,t){-1===t.text.indexOf(s)?t.node.addClass("is-hidden"):t.parents.addClass("searched-parent")}))}),x.on("focus.press-this input.press-this propertychange.press-this",T),1}function H(){I(".categories-select").find("li").each(function(){var e=I(this);m.push({node:e,parents:e.parents("li"),text:e.children(".category").text().toLowerCase()})})}return p.ready(function(){$(),z(),H()}),{renderNotice:B,renderError:R}}}(jQuery,window);